<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDGs ë§ˆìŠ¤í„° íŠ¸ë ˆì´ë„ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <style>
        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            background-color: #202020;
            background-image: radial-gradient(#333 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .pixel-font { font-family: 'Press Start 2P', cursive; }
        
        /* ë ˆíŠ¸ë¡œ ê²Œì„ ë³´ì´ ìŠ¤íƒ€ì¼ */
        .game-boy-border {
            border: 4px solid #000;
            box-shadow: 8px 8px 0px rgba(0,0,0,0.5);
            border-radius: 4px;
        }
        .game-screen {
            background-color: #f8f9fa;
            border: 4px solid #333;
            border-radius: 8px 8px 30px 8px;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
        }
        .dialog-box {
            background: white;
            border: 4px solid #000;
            padding: 10px;
            position: relative;
        }
        .dialog-box::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 10px;
            border-width: 10px 10px 0;
            border-style: solid;
            border-color: #000 transparent;
        }
        
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .retro-btn {
            background: #ef4444; /* Pokemon Red */
            color: white;
            border: 4px solid #991b1b;
            border-bottom-width: 8px;
            transition: all 0.1s;
        }
        .retro-btn:active {
            transform: translateY(4px);
            border-bottom-width: 4px;
        }
        .retro-btn:disabled {
            background: #718096;
            border-color: #4a5568;
            cursor: not-allowed;
            border-bottom-width: 4px;
            transform: translateY(4px);
        }

        /* ë’¤ë¡œê°€ê¸° ë²„íŠ¼ */
        .back-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #cbd5e1;
            border: 2px solid #000;
            padding: 2px 8px;
            font-size: 10px;
            font-weight: bold;
            border-radius: 4px;
            cursor: pointer;
            z-index: 20;
        }
        .back-btn:hover { background: #94a3b8; }

        /* ê·¸ë¦¬ë“œ ì•„ì´í…œ ìŠ¤íƒ€ì¼ */
        .grid-item {
            transition: all 0.3s;
            position: relative;
            background-color: #cbd5e1; /* slate-300 */
        }
        
        /* 1. ì ê¸´ ìƒíƒœ (ìŠ¤ìº” ì „) */
        .grid-item.locked img {
            filter: brightness(0) invert(0.8); /* ì‹¤ë£¨ì—£ */
            opacity: 0.5;
        }
        
        /* 2. ìŠ¤ìº”ë¨ (ì„ íƒ ê°€ëŠ¥, í•˜ì§€ë§Œ ë¯¸íšë“) */
        .grid-item.scanned {
            background-color: white !important;
        }
        .grid-item.scanned img {
            filter: grayscale(100%); /* í‘ë°± */
            opacity: 0.8;
        }

        /* 3. íšë“ì™„ë£Œ (ë°°ì§€ íšë“) */
        .grid-item.earned {
            background-color: #fef08a !important; /* yellow-200 */
            border-color: #eab308 !important;
        }
        .grid-item.earned img {
            filter: none; /* ì»¬ëŸ¬ */
            opacity: 1;
        }
        .grid-item.earned::after {
            content: 'â˜…';
            position: absolute;
            top: -5px;
            left: -5px;
            color: #ef4444;
            font-size: 12px;
            font-weight: bold;
            z-index: 5;
        }

        /* 4. ì„ íƒë¨ (í•˜ì´ë¼ì´íŠ¸) */
        .grid-item.selected {
            border-color: #ef4444 !important; /* Red border */
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }

        /* ì¤‘ìš”: í™”ë©´ ìˆ¨ê¹€ ì²˜ë¦¬ */
        .hidden-section { 
            display: none !important; 
        }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .pokemon-bounce {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- ë©”ì¸ ê²Œì„ê¸° í”„ë ˆì„ -->
    <div class="relative w-full max-w-md bg-red-600 rounded-b-3xl rounded-t-xl p-4 shadow-2xl game-boy-border">
        
        <!-- ìƒë‹¨ ì¥ì‹ -->
        <div class="absolute top-0 left-0 w-full h-8 border-b-4 border-black/20 bg-red-700 rounded-t-lg"></div>
        <div class="flex justify-between items-center mb-4 mt-2 px-2">
            <div class="text-white font-bold tracking-widest text-xs">â— BATTERY</div>
            <div class="text-white/80 font-black text-xs">SDG-BOY COLOR</div>
        </div>

        <!-- ìŠ¤í¬ë¦° ì˜ì—­ -->
        <div class="game-screen bg-[#98c99f] h-[600px] overflow-y-auto overflow-x-hidden relative flex flex-col p-4">
            
            <!-- 0. ì‹œì‘ í™”ë©´ -->
            <div id="screen-start" class="fade-in flex flex-col items-center justify-center h-full w-full z-10">
                <div class="w-32 h-32 bg-white rounded-full border-8 border-black flex items-center justify-center mb-6 relative overflow-hidden pokemon-bounce">
                    <!-- í”¼ì¹´ì¸„ ì´ë¯¸ì§€ -->
                    <img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png" class="w-28 h-28 object-contain" alt="Pikachu">
                </div>
                
                <h1 class="text-2xl font-black text-slate-800 mb-2 text-center leading-tight">SDGs<br>ë§ˆìŠ¤í„° íŠ¸ë ˆì´ë„ˆ</h1>
                <p class="text-xs text-slate-700 font-bold mb-4">ëª¨ë“  íŒŒíŠ¸ë„ˆë¥¼ ìˆ˜ì§‘í•˜ë¼!</p>

                <!-- ë°°ì§€ í˜„í™©íŒ -->
                <div class="bg-slate-800 text-white rounded p-2 mb-6 w-full max-w-[200px] text-center border-2 border-slate-600">
                    <div class="text-[10px] text-slate-400">CURRENT BADGES</div>
                    <div class="text-xl font-black text-yellow-400 tracking-widest" id="start-badge-count">0 / 17</div>
                </div>

                <div class="w-full space-y-3">
                    <div class="bg-white border-2 border-black p-2 rounded">
                        <input type="text" id="trainer-name" placeholder="íŠ¸ë ˆì´ë„ˆ ì´ë¦„ ì…ë ¥" class="w-full text-center outline-none font-bold bg-transparent text-black">
                    </div>
                    <button onclick="startGame()" class="retro-btn w-full py-3 font-bold text-lg rounded">
                        ëª¨í—˜ ì‹œì‘ (START)
                    </button>
                </div>
            </div>

            <!-- 1. ë„ê° ë“±ë¡ (17ê°œ í•™ìŠµ ë° ì„ íƒ) -->
            <div id="screen-pokedex" class="hidden-section w-full h-full flex flex-col relative pt-8">
                <button onclick="goBack('screen-start')" class="back-btn">â—€ ì²˜ìŒìœ¼ë¡œ</button>
                
                <div class="bg-slate-800 text-white p-2 text-xs font-bold mb-2 border-2 border-black text-center">
                    íŒŒíŠ¸ë„ˆ ì„ íƒ (íšë“: <span id="pokedex-count">0</span>/17)
                </div>
                
                <!-- 17ê°œ í¬ì¼“ëª¬ ê·¸ë¦¬ë“œ -->
                <div id="sdg-grid" class="grid grid-cols-4 gap-1 flex-1 overflow-y-auto mb-4 p-1 border-2 border-black/10 bg-white/50 rounded">
                    <!-- JSë¡œ ìƒì„±ë¨ -->
                </div>

                <div class="dialog-box mb-2 h-20 flex items-center">
                    <p class="text-[11px] font-bold leading-relaxed w-full" id="pokedex-msg">
                        ë°•ì‚¬ë‹˜: "ë°ì´í„° ìŠ¤ìº”ì„ ë¨¼ì € ì™„ë£Œí•˜ê±°ë¼!"
                    </p>
                </div>

                <button id="scan-btn" onclick="scanPokedex()" class="retro-btn w-full py-3 font-bold rounded">
                    ë°ì´í„° ìŠ¤ìº” (SCAN)
                </button>
                <button id="next-mission-btn" onclick="confirmSelection()" class="hidden w-full bg-blue-600 text-white border-4 border-blue-800 py-3 font-bold rounded game-boy-border hover:bg-blue-500 disabled:opacity-50">
                    ì´ íŒŒíŠ¸ë„ˆë¡œ ê²°ì •! â–¶
                </button>
            </div>

            <!-- 2. í€´ì¦ˆ ë°°í‹€ (ì„¤ëª…ì„ ë³´ê³  ì œëª© ë§ì¶”ê¸°) -->
            <div id="screen-quiz" class="hidden-section w-full h-full flex flex-col justify-between pt-8">
                <button onclick="goBack('screen-pokedex')" class="back-btn">â—€ ë„ê°ìœ¼ë¡œ</button>
                
                <div class="bg-black text-white p-1 text-xs text-center border-b-4 border-red-500">
                    BATTLE PHASE 1
                </div>

                <div class="flex-1 flex flex-col items-center justify-center">
                    <div class="text-sm font-bold text-slate-700 mb-2 w-full text-center px-2">
                        <span class="text-blue-600">ì´ í¬ì¼“ëª¬</span>ì˜<br>ëª©í‘œ(ë‚´ìš©)ë¥¼ í™•ì¸í•´ë¼!
                    </div>
                    <div class="w-full bg-slate-200 border-4 border-black p-4 mb-4 text-center relative">
                        <!-- ì´ë¯¸ì§€ í‘œì‹œ -->
                        <div class="absolute -top-3 -left-3 bg-red-500 text-white text-[10px] px-2 py-1 font-bold rounded border border-black transform -rotate-12">SDG No.<span id="quiz-num">?</span></div>
                        <img id="quiz-img" src="" class="w-16 h-16 mx-auto mb-2 animate-bounce object-contain">
                        
                        <!-- íŒíŠ¸: SDG ì„¤ëª… (Content) -->
                        <div class="mt-2 bg-white p-2 rounded border border-slate-300 shadow-sm">
                            <p id="quiz-question" class="font-bold text-sm text-slate-800 break-keep leading-relaxed">
                                ì„¤ëª… ë¡œë”©ì¤‘...
                            </p>
                        </div>
                        <p class="text-[10px] text-slate-500 mt-1">â–² ìœ„ ì„¤ëª…ì— í•´ë‹¹í•˜ëŠ” ëª©í‘œëŠ”?</p>
                    </div>
                </div>

                <div id="quiz-options" class="grid grid-cols-1 gap-2 mb-2">
                    <!-- ì˜µì…˜ ë²„íŠ¼ ìƒì„±ë¨ -->
                </div>
                
                <div id="quiz-feedback" class="bg-slate-800 text-green-400 text-xs p-2 font-mono hidden text-center">
                    íš¨ê³¼ê°€ êµ‰ì¥í–ˆë‹¤!
                </div>
            </div>

            <!-- 3. ì•„ì´ë””ì–´ ìŠ¬ë¡¯ë¨¸ì‹  (ê¸°ìˆ  ë¨¸ì‹ ) -->
            <div id="screen-slot" class="hidden-section w-full h-full flex flex-col pt-8">
                <button onclick="goBack('screen-quiz')" class="back-btn">â—€ ë°°í‹€ë¡œ</button>
                
                <div class="bg-black text-white p-1 text-xs text-center border-b-4 border-yellow-500">
                    BATTLE PHASE 2
                </div>
                
                <div class="mt-4 mb-2 text-center">
                    <h3 class="font-black text-lg">ê¸°ìˆ  ë¨¸ì‹  ì¡°í•©</h3>
                    <p class="text-[10px] text-slate-600">ë‚´ íŒŒíŠ¸ë„ˆì™€ í•¨ê»˜ í•´ê²°í•  ë„êµ¬ë¥¼ ì°¾ì•„ë¼!</p>
                </div>

                <div class="flex gap-1 mb-4 h-24">
                    <!-- Slot 1: ì„ íƒí•œ ëª©í‘œ (ê³ ì •) -->
                    <div class="flex-1 border-4 border-black bg-white flex flex-col items-center justify-center relative overflow-hidden">
                        <span class="absolute top-1 left-1 text-[8px] bg-red-500 text-white px-1">TARGET</span>
                        <div id="slot-1" class="font-bold text-sm text-center p-1 break-keep text-red-600">?</div>
                    </div>
                    <div class="flex items-center font-black">X</div>
                    <!-- Slot 2: ë„êµ¬ (ëœë¤) -->
                    <div class="flex-1 border-4 border-black bg-white flex flex-col items-center justify-center relative overflow-hidden">
                        <span class="absolute top-1 left-1 text-[8px] bg-blue-500 text-white px-1">ITEM</span>
                        <div id="slot-2" class="font-bold text-sm text-center p-1 break-keep">?</div>
                    </div>
                </div>

                <div id="slot-controls">
                    <button id="spin-btn" onclick="spinSlot()" class="retro-btn w-full py-4 text-lg font-black rounded shadow-lg">
                        ìŠ¬ë¡¯ ëŒë¦¬ê¸° (SPIN)
                    </button>
                </div>

                <div id="slot-result" class="hidden bg-white border-4 border-black p-3 rounded mt-2">
                    <p class="text-xs font-bold mb-2 text-center">â–¼ ë¯¸ì…˜: ì˜† ì‚¬ëŒì—ê²Œ ì„¤ëª…í•˜ê¸°</p>
                    <p class="text-sm text-center bg-slate-100 p-2 rounded break-keep">
                        "<span id="res-item" class="text-blue-600 font-bold"></span>"(ìœ¼)ë¡œ<br>
                        "<span id="res-target" class="text-red-600 font-bold"></span>" í•´ê²°í•˜ê¸°!
                    </p>
                    <button onclick="goPledge()" class="mt-2 w-full bg-green-600 text-white py-2 text-xs font-bold border-2 border-black">
                        ê³µê²© ì„±ê³µ (ë‹¤ìŒ ë‹¨ê³„)
                    </button>
                </div>
            </div>

            <!-- 4. ì„œì•½ (ë§ì¶¤í˜• í–‰ë™ ì„ íƒ) -->
            <div id="screen-pledge" class="hidden-section w-full h-full flex flex-col pt-8">
                <button onclick="goBack('screen-slot')" class="back-btn">â—€ ê¸°ìˆ ë¨¸ì‹ ìœ¼ë¡œ</button>
                
                <div class="bg-black text-white p-1 text-xs text-center border-b-4 border-green-500">
                    FINAL SYNC
                </div>

                <div class="flex-1 flex flex-col items-center justify-center text-center p-2">
                    <h3 class="font-black text-sm mb-2">íŒŒíŠ¸ë„ˆì™€ í•¨ê»˜í• <br>í–‰ë™ì„ ì„ íƒí•´ë¼!</h3>
                    
                    <!-- í˜„ì¬ íŒŒíŠ¸ë„ˆ í‘œì‹œ -->
                    <div class="mb-4 bg-slate-200 border-4 border-slate-400 p-2 rounded-full w-24 h-24 flex items-center justify-center mx-auto relative">
                        <img id="pledge-partner-img" src="" class="w-20 h-20 object-contain pokemon-bounce">
                        <div class="absolute -bottom-2 bg-black text-white text-[10px] px-2 rounded-full border border-white" id="pledge-partner-name">...</div>
                    </div>

                    <!-- ë§ì¶¤í˜• í–‰ë™ ë¦¬ìŠ¤íŠ¸ (JSë¡œ ìƒì„±) -->
                    <div id="action-list" class="grid grid-cols-1 gap-2 w-full overflow-y-auto max-h-[220px]">
                        <!-- JSê°€ ì±„ì›Œë„£ìŒ -->
                    </div>
                </div>
            </div>

            <!-- 5. ê²°ê³¼ (íŠ¸ë ˆì´ë„ˆ ì¹´ë“œ) -->
            <div id="screen-result" class="hidden-section w-full h-full flex flex-col items-center justify-center bg-slate-900 absolute top-0 left-0 z-50">
                <div class="bg-[#f0f0f0] w-full max-w-xs border-4 border-yellow-400 rounded-lg p-4 shadow-[0_0_20px_rgba(255,255,0,0.5)] relative">
                    <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-blue-600 text-white px-4 py-1 text-xs font-black border-2 border-white rounded-full">
                        TRAINER CARD
                    </div>

                    <div class="flex gap-4 mt-4 mb-4 border-b-2 border-slate-300 pb-4">
                        <div class="w-16 h-16 bg-white border-2 border-slate-500 flex items-center justify-center overflow-hidden rounded relative">
                            <img id="card-img" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" class="w-full h-full object-contain p-1">
                        </div>
                        <div>
                            <div class="text-[10px] text-slate-500 font-bold">NAME</div>
                            <div id="card-name" class="text-lg font-black text-slate-900 truncate w-24">---</div>
                            <div class="text-[10px] text-slate-500 font-bold mt-1">ID No.</div>
                            <div class="text-xs font-mono text-slate-800">2030-SDG-17</div>
                        </div>
                    </div>

                    <div class="space-y-2 text-sm text-slate-800">
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-slate-600 text-xs">COLLECTION</span>
                            <span id="card-badges" class="font-black text-red-500">0/17</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-slate-600 text-xs">NEW PARTNER</span>
                            <span id="card-partner" class="font-black text-blue-600 text-xs text-right">---</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-slate-600 text-xs">ACTION</span>
                            <span id="card-pledge" class="font-black text-green-600 text-xs text-right">---</span>
                        </div>
                    </div>

                    <div class="mt-4 bg-slate-800 text-white p-2 text-[10px] text-center rounded border border-black">
                        "ì§€ì†ê°€ëŠ¥í•œ ë¯¸ë˜ë¥¼ ìœ„í•œ<br>ë§ˆìŠ¤í„° íŠ¸ë ˆì´ë„ˆì„ì„ ì¸ì¦í•¨"
                    </div>
                </div>

                <div class="mt-6 text-center">
                    <p class="text-white text-[10px] mb-2">ëª¨ë“  íŒŒíŠ¸ë„ˆë¥¼ ëª¨ì„ ë•Œê¹Œì§€ ë„ì „í•˜ì„¸ìš”!</p>
                    <button onclick="restartGame()" class="text-yellow-400 font-bold text-xs underline cursor-pointer hover:text-white border-2 border-transparent hover:border-white p-1 rounded">
                        â†» ë‹¤ë¥¸ íŒŒíŠ¸ë„ˆ ì°¾ìœ¼ëŸ¬ ê°€ê¸° (ì¬ì‹œì‘)
                    </button>
                </div>
            </div>

        </div>

        <!-- í•˜ë‹¨ ì»¨íŠ¸ë¡¤ëŸ¬ ì¥ì‹ -->
        <div class="mt-6 flex justify-between items-end px-4">
            <div class="w-24 h-24 bg-black rounded-full flex items-center justify-center relative shadow-lg">
                <div class="w-8 h-24 bg-slate-800 absolute rounded"></div>
                <div class="w-24 h-8 bg-slate-800 absolute rounded"></div>
            </div>
            <div class="space-x-4 mb-4">
                <div class="inline-block w-12 h-12 bg-red-800 rounded-full shadow-inner border-b-4 border-red-900 transform active:translate-y-1">
                    <span class="block text-center text-red-900 font-bold text-xs mt-12">B</span>
                </div>
                <div class="inline-block w-12 h-12 bg-red-800 rounded-full shadow-inner border-b-4 border-red-900 transform active:translate-y-1">
                    <span class="block text-center text-red-900 font-bold text-xs mt-12">A</span>
                </div>
            </div>
        </div>

    </div>

    <script>
        // SDGs 17ê°œ ë°ì´í„° (í–‰ë™(actions) ë°ì´í„° ì¶”ê°€ë¨)
        const sdgsData = [
            { id: 1, title: "ë¹ˆê³¤ í‡´ì¹˜", desc: "ëª¨ë“  ê³³ì—ì„œ ëª¨ë“  í˜•íƒœì˜ ë¹ˆê³¤ì„ ì—†ì•±ë‹ˆë‹¤.", pokeId: 19, actions: ["ìš©ëˆ ì•„ê»´ ê¸°ë¶€í•˜ê¸°", "ë‚˜ëˆ” ì¥í„° ì°¸ì—¬í•˜ê¸°", "ì¹œêµ¬ì™€ ê°„ì‹ ë‚˜ëˆ„ê¸°"] }, 
            { id: 2, title: "ê¸°ì•„ ì¢…ì‹", desc: "ê¸°ì•„ë¥¼ ëë‚´ê³  ì‹ëŸ‰ ì•ˆë³´ë¥¼ ë‹¬ì„±í•©ë‹ˆë‹¤.", pokeId: 143, actions: ["ìŒì‹ ë‚¨ê¸°ì§€ ì•Šê¸°", "í¸ì‹í•˜ì§€ ì•Šê¸°", "ì§€ì—­ ë†ì‚°ë¬¼ ë¨¹ê¸°"] },
            { id: 3, title: "ê±´ê°•ê³¼ ì›°ë¹™", desc: "ëª¨ë“  ì—°ë ¹ì¸µì˜ ê±´ê°•í•œ ì‚¶ì„ ë³´ì¥í•©ë‹ˆë‹¤.", pokeId: 113, actions: ["í•˜ë£¨ 30ë¶„ ìš´ë™í•˜ê¸°", "ì† ê¹¨ë—ì´ ì”»ê¸°", "ì¼ì° ìê³  ì¼ì° ì¼ì–´ë‚˜ê¸°"] },
            { id: 4, title: "ì–‘ì§ˆì˜ êµìœ¡", desc: "ëª¨ë‘ì—ê²Œ í‰ë“±í•œ ì–‘ì§ˆì˜ êµìœ¡ì„ ì œê³µí•©ë‹ˆë‹¤.", pokeId: 63, actions: ["í•˜ë£¨ í•œ ê¶Œ ì±… ì½ê¸°", "ì¹œêµ¬ì—ê²Œ ëª¨ë¥´ëŠ” ê²ƒ ì•Œë ¤ì£¼ê¸°", "ìƒˆë¡œìš´ ì·¨ë¯¸ ë°°ìš°ê¸°"] },
            { id: 5, title: "ì„±í‰ë“±", desc: "ì„±í‰ë“±ì„ ë‹¬ì„±í•˜ê³  ì—¬ì„±ì˜ ì—­ëŸ‰ì„ ê°•í™”í•©ë‹ˆë‹¤.", pokeId: 31, actions: ["ì„±ë³„ ê³ ì •ê´€ë… ë²„ë¦¬ê¸°", "ì„œë¡œ ì¡´ì¤‘í•˜ëŠ” ë§ ì“°ê¸°", "ì§‘ì•ˆì¼ ê³µí‰í•˜ê²Œ ë‚˜ëˆ„ê¸°"] },
            { id: 6, title: "ë¬¼ê³¼ ìœ„ìƒ", desc: "ëª¨ë‘ë¥¼ ìœ„í•œ ë¬¼ê³¼ ìœ„ìƒì˜ ì´ìš©ì„ ë³´ì¥í•©ë‹ˆë‹¤.", pokeId: 7, actions: ["ì–‘ì¹˜ì»µ ì‚¬ìš©í•˜ê¸°", "ìƒ¤ì›Œ ì‹œê°„ ì¤„ì´ê¸°", "ê¸°ë¦„ê¸° ìˆëŠ” ì ‘ì‹œ ë‹¦ê³  ì”»ê¸°"] },
            { id: 7, title: "ì²­ì • ì—ë„ˆì§€", desc: "ì ì • ê°€ê²©ì˜ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì—ë„ˆì§€ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.", pokeId: 25, actions: ["ì•ˆ ì“°ëŠ” í”ŒëŸ¬ê·¸ ë½‘ê¸°", "ë‚®ì—ëŠ” ë¶ˆ ë„ê¸°", "ê³„ë‹¨ ì´ìš©í•˜ê¸°"] },
            { id: 8, title: "ì¢‹ì€ ì¼ìë¦¬", desc: "ì§€ì†ê°€ëŠ¥í•œ ê²½ì œ ì„±ì¥ê³¼ ì¼ìë¦¬ë¥¼ ì¦ì§„í•©ë‹ˆë‹¤.", pokeId: 66, actions: ["ê³µì •ë¬´ì—­ ì´ˆì½œë¦¿ ë¨¹ê¸°", "ë¶€ëª¨ë‹˜ ì¼ì† ë•ê¸°", "ì•ˆì „í•˜ê²Œ ìƒí™œí•˜ê¸°"] },
            { id: 9, title: "ì‚°ì—… í˜ì‹ ", desc: "íƒ„ë ¥ì ì¸ ì‚¬íšŒê¸°ë°˜ì‹œì„¤ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.", pokeId: 81, actions: ["ë°œëª… ì•„ì´ë””ì–´ ë‚´ê¸°", "ê³ ì¥ ë‚œ ë¬¼ê±´ ê³ ì³ ì“°ê¸°", "ëŒ€ì¤‘êµí†µ ì´ìš©í•˜ê¸°"] },
            { id: 10, title: "ë¶ˆí‰ë“± ê°ì†Œ", desc: "êµ­ê°€ ë‚´, êµ­ê°€ ê°„ ë¶ˆí‰ë“±ì„ ì¤„ì…ë‹ˆë‹¤.", pokeId: 115, actions: ["ì¹œêµ¬ ì°¨ë³„í•˜ì§€ ì•Šê¸°", "ê³ ìš´ ë§ ì‚¬ìš©í•˜ê¸°", "ë„ì›€ì´ í•„ìš”í•œ ì¹œêµ¬ ë•ê¸°"] },
            { id: 11, title: "ì§€ì†ê°€ëŠ¥ ë„ì‹œ", desc: "í¬ìš©ì ì´ê³  ì•ˆì „í•œ ë„ì‹œë¥¼ ë§Œë“­ë‹ˆë‹¤.", pokeId: 16, actions: ["ì“°ë ˆê¸° ì¤ê¸°", "ì¬í™œìš© ë¶„ë¦¬ë°°ì¶œ ì˜í•˜ê¸°", "ìì „ê±° íƒ€ê¸°"] },
            { id: 12, title: "ì±…ì„ ì†Œë¹„", desc: "ì§€ì†ê°€ëŠ¥í•œ ì†Œë¹„ì™€ ìƒì‚° ì–‘ì‹ì„ ë³´ì¥í•©ë‹ˆë‹¤.", pokeId: 52, actions: ["í…€ë¸”ëŸ¬ ì‚¬ìš©í•˜ê¸°", "ë¹„ë‹ë´‰ì§€ ëŒ€ì‹  ì¥ë°”êµ¬ë‹ˆ", "í•„ìš”í•œ ë¬¼ê±´ë§Œ ì‚¬ê¸°"] },
            { id: 13, title: "ê¸°í›„ í–‰ë™", desc: "ê¸°í›„ë³€í™”ì™€ ê·¸ ì˜í–¥ì— ê¸´ê¸‰íˆ ëŒ€ì‘í•©ë‹ˆë‹¤.", pokeId: 38, actions: ["ê³ ê¸° ì—†ëŠ” ì‹ë‹¨ ë„ì „", "ë‚˜ë¬´ ì‹¬ê¸°", "ê°€ê¹Œìš´ ê±°ë¦¬ëŠ” ê±·ê¸°"] },
            { id: 14, title: "í•´ì–‘ ìƒíƒœê³„", desc: "í•´ì–‘ ìì›ì„ ë³´ì¡´í•˜ê³  ì§€ì†ê°€ëŠ¥í•˜ê²Œ ì‚¬ìš©í•©ë‹ˆë‹¤.", pokeId: 131, actions: ["í”Œë¼ìŠ¤í‹± ë¹¨ëŒ€ ì•ˆ ì“°ê¸°", "ë°”ë‹·ê°€ ì“°ë ˆê¸° ì¤ê¸°", "ë¬¼í‹°ìŠˆ ì‚¬ìš© ì¤„ì´ê¸°"] },
            { id: 15, title: "ìœ¡ìƒ ìƒíƒœê³„", desc: "ìœ¡ìƒ ìƒíƒœê³„ë¥¼ ë³´í˜¸í•˜ê³  ë³µì›í•©ë‹ˆë‹¤.", pokeId: 1, actions: ["ì´ë©´ì§€ í™œìš©í•˜ê¸°", "ë™ë¬¼ ë³´í˜¸í•˜ê¸°", "ì¢…ì´ì»µ ì•ˆ ì“°ê¸°"] },
            { id: 16, title: "í‰í™”ì™€ ì •ì˜", desc: "í‰í™”ë¡­ê³  í¬ìš©ì ì¸ ì‚¬íšŒë¥¼ ì¦ì§„í•©ë‹ˆë‹¤.", pokeId: 149, actions: ["ì¹œêµ¬ ì´ì•¼ê¸° ê²½ì²­í•˜ê¸°", "ë”°ëŒë¦¼ ì‹œí‚¤ì§€ ì•Šê¸°", "ê·œì¹™ ì˜ ì§€í‚¤ê¸°"] },
            { id: 17, title: "íŒŒíŠ¸ë„ˆì‹­", desc: "ì´í–‰ ìˆ˜ë‹¨ì„ ê°•í™”í•˜ê³  ê¸€ë¡œë²Œ íŒŒíŠ¸ë„ˆì‹­ì„ í™œì„±í™”í•©ë‹ˆë‹¤.", pokeId: 151, actions: ["ì¹œêµ¬ì™€ í˜‘ë™í•˜ê¸°", "ì„œë¡œ ì¹­ì°¬í•˜ê¸°", "í•¨ê»˜ ë¬¸ì œ í•´ê²°í•˜ê¸°"] }
        ];

        const tools = ["ìŠ¤ë§ˆíŠ¸í°", "ë“œë¡ ", "3D í”„ë¦°í„°", "ìì „ê±°", "SNS", "íƒœì–‘ê´‘ íŒ¨ë„", "ì¸ê³µì§€ëŠ¥", "ë¡œë´‡", "ì¬í™œìš© ë°•ìŠ¤", "ìœ íŠœë¸Œ"];
        let trainerName = "";
        let selectedMission = null; // ì‚¬ìš©ìê°€ ì„ íƒí•œ ëª©í‘œ ê°ì²´
        let isScanComplete = false;
        
        // ì¤‘ìš”: íšë“í•œ ë°°ì§€ë¥¼ ì €ì¥í•˜ëŠ” Set (ì¤‘ë³µ ì œê±°)
        const earnedBadges = new Set();

        // í™”ë©´ ì „í™˜
        function showScreen(id) {
            document.querySelectorAll('.game-screen > div').forEach(el => {
                if(el.id && el.id.startsWith('screen-')) {
                    el.classList.add('hidden-section');
                    el.classList.remove('fade-in');
                }
            });
            const target = document.getElementById(id);
            target.classList.remove('hidden-section');
            target.classList.add('fade-in');

            // í™”ë©´ ì§„ì… ì‹œ íŠ¹ì • ë¡œì§ ì‹¤í–‰
            if(id === 'screen-slot') {
                resetSlotMachine();
            }
        }

        function goBack(targetId) {
            showScreen(targetId);
        }

        // 1. ê²Œì„ ì‹œì‘
        function startGame() {
            const nameInput = document.getElementById('trainer-name');
            if(!nameInput.value) { alert("íŠ¸ë ˆì´ë„ˆ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!"); return; }
            trainerName = nameInput.value;
            
            selectedMission = null;
            isScanComplete = false;
            
            // UI ì´ˆê¸°í™”
            document.getElementById('pokedex-msg').innerHTML = `ë°•ì‚¬ë‹˜: "17ë§ˆë¦¬ì˜ íŒŒíŠ¸ë„ˆë¥¼ ëª¨ë‘ ëª¨ì•„ë³´ê±°ë¼!"`;
            const scanBtn = document.getElementById('scan-btn');
            scanBtn.classList.remove('hidden');
            scanBtn.disabled = false;
            scanBtn.innerText = "ë°ì´í„° ìŠ¤ìº” (SCAN)";
            
            const nextBtn = document.getElementById('next-mission-btn');
            nextBtn.classList.add('hidden');
            nextBtn.disabled = true;

            // ë„ê° í˜„í™© ì—…ë°ì´íŠ¸
            document.getElementById('pokedex-count').innerText = earnedBadges.size;

            // ë„ê° ìƒì„±
            const grid = document.getElementById('sdg-grid');
            grid.innerHTML = "";
            sdgsData.forEach(sdg => {
                const div = document.createElement('div');
                div.className = "grid-item locked aspect-square flex flex-col items-center justify-center p-1 rounded cursor-pointer border border-slate-400 select-none";
                
                // ì´ë¯¸ íšë“í•œ ë°°ì§€ ì²´í¬
                if (earnedBadges.has(sdg.id)) {
                    div.classList.remove('locked');
                    div.classList.add('earned');
                }

                const img = document.createElement('img');
                img.src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${sdg.pokeId}.png`;
                img.className = "w-full h-full object-contain";
                div.appendChild(img);

                div.id = `sdg-cell-${sdg.id}`;
                div.onclick = () => selectMission(sdg);
                grid.appendChild(div);
            });

            showScreen('screen-pokedex');
        }

        // 2. ë„ê° ìŠ¤ìº”
        function scanPokedex() {
            const btn = document.getElementById('scan-btn');
            btn.disabled = true;
            btn.innerText = "ìŠ¤ìº” ì¤‘...";
            
            let i = 0;
            const interval = setInterval(() => {
                if(i >= sdgsData.length) {
                    clearInterval(interval);
                    isScanComplete = true;
                    document.getElementById('pokedex-msg').innerHTML = "<span class='text-blue-600'>ìŠ¤ìº” ì™„ë£Œ!</span><br>ì´ ì¤‘ ë§ˆìŒì— ë“œëŠ” íŒŒíŠ¸ë„ˆë¥¼ <span class='text-red-600'>ì„ íƒ</span>í•´ë¼!";
                    btn.classList.add('hidden');
                    document.getElementById('next-mission-btn').classList.remove('hidden');
                    return;
                }
                
                const cell = document.getElementById(`sdg-cell-${sdgsData[i].id}`);
                // ì´ë¯¸ íšë“í•œ ê²Œ ì•„ë‹ˆë©´ í‘ë°± ì˜¤í”ˆ
                if (!cell.classList.contains('earned')) {
                    cell.classList.remove('locked');
                    cell.classList.add('scanned');
                }
                
                // ì£¼ì˜: ì—¬ê¸°ì„œ Titleì„ ë³´ì—¬ì£¼ì§€ ì•ŠìŒ (ì •ë‹µ ìœ ì¶œ ë°©ì§€)
                cell.title = `SDG #${sdgsData[i].id}`; 
                
                // ë²ˆí˜¸ ë±ƒì§€
                if(!cell.querySelector('.badge-num')) {
                    const badge = document.createElement('div');
                    badge.className = "badge-num absolute top-0 right-0 bg-black text-white text-[8px] px-1 rounded-bl";
                    badge.innerText = sdgsData[i].id;
                    cell.appendChild(badge);
                }

                i++;
            }, 30);
        }

        // 2.5 ëª©í‘œ ì„ íƒ (ì •ë³´ ìˆ¨ê¹€ - í˜¸ê¸°ì‹¬ ìœ ë°œ)
        function selectMission(sdg) {
            if(!isScanComplete) return; 

            selectedMission = sdg;
            
            document.querySelectorAll('.grid-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`sdg-cell-${sdg.id}`).classList.add('selected');
            
            // ì œëª©ê³¼ ì„¤ëª…ì„ ìˆ¨ê¸°ê³  ë²ˆí˜¸ë§Œ ë³´ì—¬ì¤Œ
            document.getElementById('pokedex-msg').innerHTML = `ì„ íƒ: <span class='text-red-600 font-bold'>SDG #${sdg.id}</span><br>ì´ íŒŒíŠ¸ë„ˆì˜ ì •ì²´ë¥¼ ë°íˆëŸ¬ ê°€ê² ë‚˜?`;
            const nextBtn = document.getElementById('next-mission-btn');
            nextBtn.disabled = false;
        }

        function confirmSelection() {
            if(!selectedMission) { alert("ëª©í‘œë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”!"); return; }
            startQuiz();
        }

        // 3. í€´ì¦ˆ ë°°í‹€ (ì„¤ëª… ë³´ê³  ì œëª© ë§ì¶”ê¸°)
        function startQuiz() {
            showScreen('screen-quiz');
            document.getElementById('quiz-num').innerText = selectedMission.id;
            generateIdentityQuiz();
        }

        function generateIdentityQuiz() {
            const answer = selectedMission;
            
            // ì´ë¯¸ì§€ í‘œì‹œ
            document.getElementById('quiz-img').src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${answer.pokeId}.png`;
            
            // í•µì‹¬ ë³€ê²½: í€´ì¦ˆ ì§ˆë¬¸ì„ "ì„¤ëª…"ìœ¼ë¡œ ë³´ì—¬ì¤Œ
            document.getElementById('quiz-question').innerText = `"${answer.desc}"`;
            
            // ì •ë‹µ + ì˜¤ë‹µ 2ê°œ
            let options = [answer];
            while(options.length < 3) {
                const wrong = sdgsData[Math.floor(Math.random() * sdgsData.length)];
                if(wrong.id !== answer.id && !options.includes(wrong)) options.push(wrong);
            }
            options.sort(() => Math.random() - 0.5);

            const btnContainer = document.getElementById('quiz-options');
            btnContainer.innerHTML = "";
            
            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "w-full bg-white border-2 border-black py-3 rounded hover:bg-slate-100 font-bold text-sm transition";
                
                // ë³´ê¸°ëŠ” "ë²ˆí˜¸: ì œëª©" (ì„¤ëª…ì€ ëºŒ, ì™œëƒí•˜ë©´ ë¬¸ì œê°€ ì„¤ëª…ì´ë‹ˆê¹Œ)
                btn.innerText = `${opt.id}ë²ˆ: ${opt.title}`;
                
                btn.onclick = () => submitQuiz(opt.id === answer.id);
                btnContainer.appendChild(btn);
            });
            
            document.getElementById('quiz-feedback').classList.add('hidden');
        }

        function submitQuiz(isCorrect) {
            const feedback = document.getElementById('quiz-feedback');
            feedback.classList.remove('hidden');
            
            if(isCorrect) {
                feedback.innerHTML = `ì •ë‹µ! ì´ íŒŒíŠ¸ë„ˆëŠ”<br><span class='text-yellow-400'>${selectedMission.title}</span> ë‹´ë‹¹ì´ë‹¤!`;
                feedback.className = "bg-blue-600 text-white font-bold p-2 border-2 border-black rounded mb-2";
                if(typeof confetti === 'function') confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 } });
                setTimeout(() => showScreen('screen-slot'), 2000);
            } else {
                feedback.innerText = "í‹€ë ¸ë‹¤! ì„¤ëª…ì„ ë‹¤ì‹œ ì˜ ì½ì–´ë´ë¼.";
                feedback.className = "bg-red-100 text-red-700 font-bold p-2 border-2 border-red-500 rounded mb-2 animate-bounce";
            }
        }

        // 4. ìŠ¬ë¡¯ ë¨¸ì‹ 
        function resetSlotMachine() {
            const btn = document.getElementById('spin-btn');
            const resultBox = document.getElementById('slot-result');
            const slot1 = document.getElementById('slot-1');
            const slot2 = document.getElementById('slot-2');
            
            btn.classList.remove('hidden');
            btn.disabled = false;
            btn.innerText = "ìŠ¬ë¡¯ ëŒë¦¬ê¸° (SPIN)";
            resultBox.classList.add('hidden');
            
            slot1.innerText = selectedMission ? selectedMission.title : "?";
            slot1.classList.add('text-red-600');
            slot2.innerText = "?";
        }

        function spinSlot() {
            const btn = document.getElementById('spin-btn');
            const resultBox = document.getElementById('slot-result');
            const slot1 = document.getElementById('slot-1');
            const slot2 = document.getElementById('slot-2');
            
            btn.disabled = true;
            resultBox.classList.add('hidden');
            slot1.innerText = selectedMission.title;

            let count = 0;
            const timer = setInterval(() => {
                slot2.innerText = tools[Math.floor(Math.random()*tools.length)];
                count++;
                if(count > 20) {
                    clearInterval(timer);
                    const finalTool = tools[Math.floor(Math.random()*tools.length)];
                    
                    slot1.innerText = selectedMission.title;
                    slot2.innerText = finalTool;
                    
                    document.getElementById('res-target').innerText = selectedMission.title;
                    document.getElementById('res-item').innerText = finalTool;
                    
                    resultBox.classList.remove('hidden');
                    btn.classList.add('hidden');
                }
            }, 80);
        }

        function goPledge() {
            // íŒŒíŠ¸ë„ˆ ì •ë³´ ì„¸íŒ…
            document.getElementById('pledge-partner-img').src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${selectedMission.pokeId}.png`;
            document.getElementById('pledge-partner-name').innerText = selectedMission.title;
            
            // ë§ì¶¤í˜• í–‰ë™ ë¦¬ìŠ¤íŠ¸ ìƒì„±
            const listContainer = document.getElementById('action-list');
            listContainer.innerHTML = "";
            
            selectedMission.actions.forEach((actionText, index) => {
                const btn = document.createElement('button');
                btn.className = "bg-white border-4 border-slate-300 hover:border-green-500 p-3 rounded-xl flex items-center gap-3 transition group text-left";
                
                const icons = ["ğŸ”¥", "ğŸŒ¿", "ğŸ’§"];
                const icon = icons[index % icons.length];

                btn.innerHTML = `
                    <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-lg">${icon}</div>
                    <div>
                        <div class="text-[9px] font-bold text-slate-500">ACTION 0${index+1}</div>
                        <div class="font-bold text-xs">${actionText}</div>
                    </div>
                `;
                btn.onclick = () => selectPledge(actionText);
                listContainer.appendChild(btn);
            });

            showScreen('screen-pledge');
        }

        // 5. ê²°ê³¼ ë° ë°°ì§€ íšë“
        function selectPledge(pledgeName) {
            earnedBadges.add(selectedMission.id);
            const currentScore = earnedBadges.size;

            document.getElementById('card-name').innerText = trainerName;
            document.getElementById('card-pledge').innerText = pledgeName;
            document.getElementById('card-partner').innerText = selectedMission.title;
            document.getElementById('card-badges').innerText = `${currentScore}/17`;
            
            document.getElementById('card-img').src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${selectedMission.pokeId}.png`;
            
            showScreen('screen-result');
            if(typeof confetti === 'function') confetti({ particleCount: 150, spread: 100, origin: { y: 0.6 } });
        }

        function restartGame() {
            document.getElementById('start-badge-count').innerText = `${earnedBadges.size} / 17`;
            showScreen('screen-start');
        }
    </script>
</body>
</html>
